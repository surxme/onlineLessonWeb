<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>添加课程</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="__STATIC__/admin/css/style.css">
    <link rel="stylesheet" href="__STATIC__/js/layui/css/layui.css">
    <link rel="stylesheet" href="__STATIC__/iconfont/iconfont.css">
    <link rel="shortcut icon" href="__STATIC__/admin/images/favicon.png" />
    <script type="text/javascript" src="__STATIC__/js/layui/layui.js"></script>
    <script type="text/javascript" src="__STATIC__/js/commom.js"></script>
    <script type="text/javascript" src="__STATIC__/js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="__STATIC__/js/layui-xtree.js"></script>

</head>
<style>
    body{
        background: #FFFFFF;
    }
    #myform .layui-form-label{
        width: 14%;
    }
    #myform .layui-input-block{
        margin-left: 15%;
    }
    #myform .layui-upload-img{
        width: 50%;
    }
</style>
<body>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>{$info['id']?'编辑':'添加'}课程</legend>
</fieldset>

<form class="layui-form" action="" id="myform"  enctype="multipart/form-data" method="POST">
    <!--<input type="number" name="teacherId" hidden value="{$Think.session.teacherid}">-->
    <div class="layui-form-item">
        <label class="layui-form-label">课程名</label>
        <div class="layui-input-block">
            <input type="text" name="name" value="{$info['name']?$info['name']:''}" lay-verify="required" autocomplete="off" placeholder="请输入课程名" class="layui-input require">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">课程类别</label>
        <div class="layui-input-block">
            <select name="tid" lay-filter="type">
                <option value=""></option>
                {volist name='lesson_type' id='value'}
                <option value="{$value.id}" {$info['type_id']?($info['type_id']==$value['id']?'selected':''):''}>{$value.name}</option>
                {/volist}
            </select>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">关联教师</label>
        <div class="layui-input-block">
            <div id="xtree1" style="border:1px solid #e6e6e6;padding: 10px 0 25px 5px;"></div>
            <input type="hidden" value="{$info['teacher_ids']?$info['teacher_ids']:''}" id="teacher_ids" name="teacher_ids">
        </div>
    </div>

    <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">课程简介</label>
        <div class="layui-input-block">
            <textarea name="intro" id="intro" placeholder="请输入内容" class="layui-textarea require">{$info['intro']?$info['intro']:''}</textarea>
        </div>
    </div>

    <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">课程封面</label>
        <div class="layui-input-block">
            <div class="layui-upload">
                <button type="button" class="layui-btn" id="test1">上传封面</button>
                <div class="layui-upload-list">
                    <img class="layui-upload-img" id="demo1" src="{$info['poster']?'__STATIC__'.$info['poster']:''}">
                    <input type="hidden" name="poster" id="poster" value="{$info['poster']?$info['poster']:''}">
                    <p id="demoText"></p>
                </div>
            </div>
        </div>
    </div>
</form>

<script>
    deptTreeBuilder('xtree1',{$dept},function (ids) {
        $('#teacher_ids').val(ids);
    });
    // layui.use(['form'], function () {
    //     var form = layui.form;
    //
    //     var xtree3 = new layuiXtree({
    //         elem: 'xtree1'   //(必填) 放置xtree的容器id，不要带#号
    //         , form: form     //(必填) layui 的 from
    //         , data: {$dept}
    //         , isopen: false  //加载完毕后的展开状态，默认值：true
    //         , ckall: true    //启用全选功能，默认值：false
    //         , ckallback: function () {
    //             xtree3.GetChecked();
    //         } //全选框状态改变后执行的回调函数
    //         , click: function (data) {  //节点选中状态改变事件监听，全选框有自己的监听事件
    //             console.log(data.elem); //得到checkbox原始DOM对象
    //             console.log(data.elem.checked); //开关是否开启，true或者false
    //             console.log(data.value); //开关value值，也可以通过data.elem.value得到
    //             console.log(data.othis); //得到美化后的DOM对象
    //         }
    //     });
    // });

    //上传文件
    file_upload_manager.normalUpload('{:url("admin/upload")}',{},'#test1','#demo1','#poster');

    // var layedit_index = layeditManager.builder('intro','{:url("admin/layeditUpload")}');

    var  index,layedit;
    layui.use('layedit', function(){
        layedit = layui.layedit;
        layedit.set({
            uploadImage: {
                url: '{:url("admin/layeditUpload")}' //接口url
            }
        });
        index = layedit.build('intro',{height:200}); //建立编辑器
    });

    function syncTexrarea() {
        layedit.sync(index);
        // console.log(layedit_index['index']);
        // console.log(layedit_index['layedit']);
        // layedit_index[layedit].sync(layedit_index[index]);
    }
    layui.use(['form', 'layer','layedit', 'laydate','upload'], function(){
        var form = layui.form;
    });
</script>

</body>
</html>